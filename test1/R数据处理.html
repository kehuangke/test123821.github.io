<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.5.18 (466207)"/><meta name="author" content="！！！"/><meta name="created" content="2021-12-10 07:42:38 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="source-url" content="https://www.statology.org/remove-multiple-rows-in-r/"/><meta name="updated" content="2023-02-08 06:35:02 +0000"/><title>R数据处理</title></head><body><div>R数据处理</div><div><br/></div><div><br/></div><div>1.截取一列字符串</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>substr(rownames(DZM_Scdata@meta.data)[0:5],1,8)</div></div><div><br/></div><div>2.选取两列</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>subset(df1,aaa>0.001)&nbsp;&nbsp; 数据选取</div><div>df_pi16[df_pi16[aa]&gt;30,]</div></div><div><br/></div><div>3.两个dataframe合并</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df=merge(tooth_data@meta.data,df_pos,by='barcode')</div></div><div><br/></div><div><br/></div><div>4.选取特定三个列组成一个dataframe</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df_pos=as.data.frame(cbind(df_pos$V1,df_pos$V5,df_pos$V6))</div><div><br/></div><div>library(dplyr)</div><div>select(df1, A, B, E)</div></div><div><br/></div><div>5.统计每个元素频率</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>table(Stdata@meta.data$cell_type)</div></div><div><br/></div><div>##R根据索引删除多行</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>new_df &lt;- df[-c(2, 3, 4), ]</div></div><div><br/></div><div>6.替换字符串中的字符</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>plot_title=gsub('[/]', '', data$V2[i])</div></div><div><br/></div><div>7.根据列名选择多列</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data_cell[c('ANXA2','x','y')]</div></div><div><br/></div><div>8.随机打乱dataframe</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df2 &lt;- df[sample(nrow(df)),]</div><div>##抽取一定数目</div><div>df_exp=df_fib[c(sample(rownames(df_fib),ceiling(dim(df_fib)[1]/10))),]</div></div><div><br/></div><div>9.符合条件的行赋值</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df$LR[which(df$LR==0)]&lt;- NA</div><div>df_fib[cell_type][df_fib[cell_type]=='a']&lt;-'b'</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">判断两个list是否在用 %in%，返回是否列表</span></div><div>df_sum_sort[df_sum_sort$cell_id %in% df_prop_neigh$cell_id,][df_prop_neigh$cell_id,]['Tem_neighbor']=df_prop_neigh$Tem_neighbor</div><div>df_sum_sort=df_sum_sort[order(df_sum_sort$Tem_neighbor),]</div></div><div><br/></div><div>10.两列连接</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>library(stringr)</div><div>data@meta.data['region']=paste(data@meta.data$inj_uninj,data@meta.data$D_V,sep='_')</div></div><div>###列分割</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df_id['cell_type']=paste(str_split_fixed(df_id$Var1,'_',4)[,3],str_split_fixed(df_id$Var1,'_',4)[,4],sep='_')</div></div><div><br/></div><div>11.###列前加字符</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data_spatial['V8']=sub("^","C",data_spatial$V7)</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>data[order(data$flavor),]</div></div><div><br/></div><div>#12 按照一列的固定顺序排序</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>library(dplyr)</div><div>df_sum_sort= df_sum_sort %&gt;% arrange(factor(celltype, levels = c('NA','Tem(TCR_pathway)','iCAF(CXCL12)')))</div><div><br/></div></div><div><br/></div><div>##13 放大legend长宽</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>theme(legend.key.size = unit(2, 'cm'))</div><div><br/></div></div><div><br/></div><div>## dataframe na 变为0.5</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>df_id[is.na(df_id)] &lt;- 0.5</div></div><div><br/></div><div>##合并多个dataframe</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>library(dplyr)</div><div>a_list=list()</div><div>a_list[[1]]&lt;-df1</div><div>a_list[[2]]&lt;-df1</div><div>aa=do.call("rbind", a_list)</div></div><div><br/></div><div>##合并多张图</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>p=patchwork::wrap_plots(plotlist,ncol = 2)</div></div><div><br/></div><div>##&nbsp;&nbsp;</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>library(scales)</div><div>myCol =c('#9A154C','#D84858','#F3754E','#5B58A7','#3489BB','#60C4A6','#9FD3A3','#DCE899','#FDDC89','#FAA966')</div><div>show_col(myCol)</div></div><div><br/></div><div><img src="R%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86.resources/89C71196-B35E-43D5-A45A-A3A20C4FB7A1.png" height="472" width="975"/></div><div><br/></div><div>R画图风格</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>plot &lt;- ggplot(df_merge, aes(x=celltype, y=PTGER3, fill=celltype)) +</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom_boxplot() + theme(</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot.title = element_text( size=30,hjust = 0.5),</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis.title.y = element_text(size = 28),</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis.text.y = element_text(size = 16),</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis.title.x = element_text(size = 25),</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis.text.x = element_text(angle = 90,size = 16), legend.position = 'None',</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.grid.major = element_blank(), panel.grid.minor = element_blank(),</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.background = element_blank(), axis.line = element_line(colour = "black")</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) +labs(,</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y ="PTGDR4 expression", x = "cell type")+scale_color_manual(</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;&nbsp;&nbsp;=color_list ,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limits = c('iCAF_PI16','iCAF_SLIT2','iCAF_ADAM28 ','mCAF_BMP4','mCAF_FAP','mCAF_MMP1'))+guides(color=guide_legend(override.aes = list(size=5)))</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></body></html>